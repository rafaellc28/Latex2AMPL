<!doctype html>
<html>
	<head>
		<title>Latex2MathProg</title>

		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="css/lib/bootstrap.min.css">
		<!--<link rel="stylesheet" href="css/lib/jquery-ui.min.css">-->
		<link rel="stylesheet" href="css/latex2mathprog.css">
		<link rel="stylesheet" href="css/lib/codemirror.css">

		<script type="text/javascript" src="js/lib/jquery-3.1.0.min.js"></script>
		<!--<script type="text/javascript" src="js/lib/jquery-ui.min.js"></script>-->
		<script src="js/lib/bootstrap.min.js"></script>
		<script src="js/lib/mustache.min.js"></script>
		<!--<script src="js/lib/jquery-sortable.js"></script>-->
		<script src="js/lib/jquery-ui.min.js"></script>

		<script src="js/lib/purl.js"></script>
		<script src="js/lib/glpk.min.js"></script>
		<script src="js/lib/codemirror.js"></script>
		<script src="js/lib/CodeMirror/addon/mode/simple.js"></script>

		<!-- MathJax -->
		<script src="js/lib/MathJax/MathJax.js">
		  MathJax.Hub.Config({
			extensions: ['tex2jax.js',"TeX/AMSmath.js","TeX/AMSsymbols.js"],
			tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
			jax: ["input/TeX","output/HTML-CSS"],
			displayAlign: "left",
			showProcessingMessages: false, 
			"HTML-CSS": {
     		   styles: {
            		".MathJax_Display": {
                		padding: "5px 5px",
                		margin: "0 0"
            		},
        		}
    		}
		  });
	  	</script>

		<script src="js/utils.js"></script>
	  	<script src="js/editor.js"></script>
	  	<script src="js/solver.js"></script>
	  	<script src="js/mathjaxpreview.js"></script>
	  	<script src="js/mathjaxdisplay.js"></script>
		<script src="js/latex2mathprog.js"></script>

	</head>
	<body onload="loadUser();">
		<div id="target">Loading...</div>
		
		<script id="template" type="x-tmpl-mustache">
			<div class="container-fluid">
				<h1>{{LATEX2MATHPROG}}</h1>

	        	<p class="text-muted">
	        		<ul>
	        			<li>{{{TIP1}}}</li>
	        			<li>{{{TIP2}}}</li>
	        			<li>{{{TIP3}}}</li>
	        			<li>{{{TIP4}}}</li>
	        			<li>{{{TIP5}}}</li>
	        		</ul>
	        	</p>

	        	<p>
	        		{{{GITHUB_SOURCE}}}
	        	</p>

				<p class="text-muted">
					{{{SIMPLE_EXAMPLE}}}
				</p>
				
				<p class="text-muted">
					{{{DATA_SECTION}}}<a href="#" data-html="true" data-toggle="popover" data-content="{{DATA_SECTION_DATA}}">data</a>.
				</p>
				
				<div id="alertObj"></div>
				<div id="alertSubj"></div>
				
				<div class="panel-group">
					<div class="panel panel-default">
					    <div class="panel-heading">
					      <h2 class="panel-title">
					        <a data-toggle="collapse" href="#collapse1">{{LATEX_EDITOR}}</a>
					      </h2>
					    </div>
					    <div id="collapse1" class="panel-collapse collapse in">
							<div class="row">
								<div class="col-xs-12 col-md-6">
									<div class="row">
										<div class="col-xs-12">
											<h3>{{LATEX_CODE}}</h3>
											<div class="input-group" style="width: 100%;">
												<span class="input-group-addon" style="width:25%">
													<select id="obj" onchange="changeObjective(this.value)">
														<option value="minimize" selected>{{MINIMIZE}}</option>
														<option value="maximize">{{MAXIMIZE}}</option>
													</select>
												</span>
												<input id="objMathInput" class="form-control" style="width:75%" onblur="UpdateObjectiveMath(this.value)" onkeyup="PreviewObjctiveFunction.Update()" data-toggle="popover" data-trigger="focus"/>
												<div id="objPreviewMathOutput" style="width:75%; visibility:hidden; position:absolute;" class="mathOutputBox">$${}$$</div>
												<div id="objPreviewMathBuffer" style="width:75%; visibility:hidden; position:absolute;" class="mathOutputBox"></div>
											</div>
										</div>

										<div class="col-xs-12">
											<div class="input-group" style="width: 100%;">
												<span class="input-group-addon" style="width:25%;">
													{{SUBJECT_TO}}
												</span>
												<div id="subjectiveMathInputBox" class="mathInputBox" style="width:75%">
													<div class="row">
														<div class="col-xs-12">
															<div id="subjectiveMathInput" style="width:100%">
																<ol class="list-group list-constraints">
																</ol>
															</div>
														</div>
													</div>
													<div class="row">
														<div class="col-xs-10">
															<input id="subjMathInput" class="form-control" style="width:100%" onkeyup="PreviewSubjctiveFunction.Update()" data-toggle="popover" data-trigger="focus"/>
															<div id="subjPreviewMathOutput" style="width:100%; visibility:hidden; position:absolute;" class="mathOutputBox">$${}$$</div>
															<div id="subjPreviewMathBuffer" style="width:100%; visibility:hidden; position:absolute;" class="mathOutputBox"></div>
														</div>
														<div class="col-xs-2" style="min-height: 34px;">
															<a id="icon-add-constraint" href="#" onclick="UpdateSubjectiveMath()">
																<i class="glyphicon glyphicon-plus" style="line-height: 34px;"></i>
															</a>
															<a id="icon-update-constraint" href="#" onclick="updateConstraintMath()" style="display: none;">
																<i class="glyphicon glyphicon-floppy-disk" style="line-height: 34px;"></i>
															</a>
														</div>
													</div>
												</div>
											</div>
										</div>

									</div>

									<div id="objectiveFunction"></div>
								</div>

								<div class="col-xs-12 col-md-6">
									<div class="row">
										<div class="col-xs-12">
											<h3>{{MATHJAX_PREVIEW}}</h3>
											<div class="input-group" style="width: 100%;">
												<span class="input-group-addon" style="width:25%">
													<div id="objective">{{MINIMIZE}}</div>
												</span>
												<div id="objectiveMathOutput" style="width:75%;" class="mathOutputBox">$${}$$</div>
											</div>
										</div>

										<div class="col-xs-12">
											<div class="input-group" style="width: 100%;">
												<span class="input-group-addon" style="width:25%">
													<div id="subject">{{SUBJECT_TO}}</div>
												</span>
												<div id="subjectiveMathOutput" class="mathOutputBox" style="width:75%">$${}$$</div>
											</div>
										</div>
									</div>

									<div class="row">&nbsp;</div>

									<div class="row">
										<div class="col-xs-12">
											<button type="button" class="btn btn-default pull-left" onClick="generateMathProg()">{{GENERATE_MATHPROG}}</button>&nbsp;
											<button type="button" class="btn btn-default pull-left" onClick="copyToSimpleEditor()">{{COPY_TO_SIMPLE_EDITOR}}</button>
										</div>
									</div>

									<div id="subjectiveFunction"></div>
								</div>
							</div>
						</div>
				    </div>
				</div>

				<div class="panel-group">
					<div class="panel panel-default">
					    <div class="panel-heading">
					      <h2 class="panel-title">
					        <a data-toggle="collapse" href="#collapse2">{{SIMPLE_EDITOR}}</a>
					      </h2>
					    </div>
					    <div id="collapse2" class="panel-collapse collapse in">
							<div class="row">
								<div class="col-xs-12 col-md-6">
									<h3>{{LATEX_CODE}}</h3>
									<div class="row">
										<div id="latexEditor" class="col-xs-12">
											<textarea id="simpleEditor" onkeyup="PreviewSimpleEditor.Update()" onchange="PreviewSimpleEditor.Update()"></textarea>
										</div>
									</div>
								</div>
								<div class="col-xs-12 col-md-6">
									<div class="row">
										<div class="col-xs-12">
											<h3>{{MATHJAX_PREVIEW}}</h3>
											<div id="mathOutput" style="width:75%;" class="mathOutputBox">$${}$$</div>
											<div id="mathOutputBuffer" style="width:75%; visibility:hidden; position:absolute;" class="mathOutputBox"></div>
										</div>
									</div>

									<div class="row">&nbsp;</div>

									<div class="row">
										<div class="col-xs-12">
											<button type="button" class="btn btn-default pull-left" onClick="generateMathProgFromSimpleEditor()">{{GENERATE_MATHPROG}}</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<h2>{{MATHPROG_CODE}}</h2>

				<div class="row">
					<div id="mathProg" class="col-xs-12">
					    <textarea id="editor"></textarea>
					</div>
				</div>

				<div class="row">&nbsp;</div>

				<div class="row">
					<div class="col-xs-12">
						<button type="button" class="btn btn-default" onClick="solveMathProg()">{{SOLVE_MATHPROG}}</button>
    				</div>
				</div>

				<div class="row">&nbsp;</div>
				
				<h2>{{MATHPROG_SOLUTION}}</h2>

				<pre id="log"/>
			</div>

			<script>
				//
				//  IE doesn't fire onchange events for RETURN, so
				//   use onkeypress to do a blur (and refocus) to
				//   force the onchange to occur
				//
				if (MathJax.Hub.Browser.isMSIE) {
					objMathInput.onkeypress = function () {
						if (window.event && window.event.keyCode === 13) {this.blur(); this.focus()}
					}

					subjMathInput.onkeypress = function () {
						if (window.event && window.event.keyCode === 13) {this.blur(); this.focus()}
					}
				}

				initExample();
			</script>

		</script>

	</body>
</html>
